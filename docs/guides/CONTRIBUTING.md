# è´¡çŒ®æŒ‡å—

æ„Ÿè°¢æ‚¨å¯¹ SillyChat çš„å…´è¶£ï¼æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨å‚ä¸é¡¹ç›®å¼€å‘ã€‚

## ç›®å½•

1. [è¡Œä¸ºå‡†åˆ™](#è¡Œä¸ºå‡†åˆ™)
2. [å¦‚ä½•è´¡çŒ®](#å¦‚ä½•è´¡çŒ®)
3. [å¼€å‘æµç¨‹](#å¼€å‘æµç¨‹)
4. [ä»£ç è§„èŒƒ](#ä»£ç è§„èŒƒ)
5. [æäº¤ä¿¡æ¯è§„èŒƒ](#æäº¤ä¿¡æ¯è§„èŒƒ)
6. [å®¡æŸ¥æµç¨‹](#å®¡æŸ¥æµç¨‹)

---

## è¡Œä¸ºå‡†åˆ™

### æˆ‘ä»¬çš„æ‰¿è¯º

- ä½¿ç”¨å‹å¥½å’ŒåŒ…å®¹çš„è¯­è¨€
- å°Šé‡ä¸åŒçš„è§‚ç‚¹å’Œç»éªŒ
- ä¼˜é›…åœ°æ¥å—å»ºè®¾æ€§æ‰¹è¯„
- å…³æ³¨å¯¹ç¤¾åŒºæœ€æœ‰åˆ©çš„äº‹æƒ…
- å¯¹å…¶ä»–ç¤¾åŒºæˆå‘˜è¡¨ç¤ºåŒç†å¿ƒ

### ä¸å¯æ¥å—çš„è¡Œä¸º

- ä½¿ç”¨æ€§åˆ«æ­§è§†ã€ç§æ—æ­§è§†æˆ–æ’ä»–æ€§è¯­è¨€
- è¿›è¡Œäººèº«æ”»å‡»æˆ–æ”¿æ²»æ”»å‡»
- å…¬å¼€æˆ–ç§ä¸‹éªšæ‰°
- æœªç»æ˜ç¡®è®¸å¯å‘å¸ƒä»–äººç§äººä¿¡æ¯
- å…¶ä»–ä¸é“å¾·æˆ–ä¸ä¸“ä¸šçš„è¡Œä¸º

---

## å¦‚ä½•è´¡çŒ®

### æŠ¥å‘Š Bug

åœ¨æäº¤ Bug æŠ¥å‘Šä¹‹å‰ï¼Œè¯·ï¼š

1. æœç´¢ç°æœ‰ Issuesï¼Œé¿å…é‡å¤
2. ä½¿ç”¨æœ€æ–°çš„å¼€å‘ç‰ˆæœ¬æµ‹è¯•
3. æ”¶é›†è¶³å¤Ÿçš„ä¿¡æ¯

**Bug æŠ¥å‘Šæ¨¡æ¿ï¼š**

```markdown
## æè¿°
ç®€è¦æè¿° Bug

## å¤ç°æ­¥éª¤
1. æ­¥éª¤ä¸€
2. æ­¥éª¤äºŒ
3. æ­¥éª¤ä¸‰

## æœŸæœ›è¡Œä¸º
æè¿°åº”è¯¥å‘ç”Ÿä»€ä¹ˆ

## å®é™…è¡Œä¸º
æè¿°å®é™…å‘ç”Ÿäº†ä»€ä¹ˆ

## ç¯å¢ƒ
- OS: [ä¾‹å¦‚ macOS 14.0]
- Node.js: [ä¾‹å¦‚ 22.12.0]
- ç‰ˆæœ¬: [ä¾‹å¦‚ 1.0.0]

## æˆªå›¾
å¦‚æœé€‚ç”¨ï¼Œæ·»åŠ æˆªå›¾

## æ—¥å¿—
```
ç²˜è´´ç›¸å…³æ—¥å¿—
```
```

### å»ºè®®æ–°åŠŸèƒ½

1. å…ˆæœç´¢æ˜¯å¦å·²æœ‰ç±»ä¼¼å»ºè®®
2. åˆ›å»º Issue å¹¶æ ‡è®°ä¸º `enhancement`
3. æè¿°åŠŸèƒ½çš„ç”¨ä¾‹å’Œé¢„æœŸè¡Œä¸º
4. ç­‰å¾…ç»´æŠ¤è€…åé¦ˆ

### æäº¤ä»£ç 

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'feat: add amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. åˆ›å»º Pull Request

---

## å¼€å‘æµç¨‹

### 1. ç¯å¢ƒè®¾ç½®

```bash
# Fork å¹¶å…‹éš†é¡¹ç›®
git clone https://github.com/YOUR_USERNAME/SillyChat.git
cd SillyChat

# æ·»åŠ ä¸Šæ¸¸ä»“åº“
git remote add upstream https://github.com/original/SillyChat.git

# å®‰è£…ä¾èµ–
npm run setup:dev
```

### 2. åˆ›å»ºåˆ†æ”¯

```bash
# ä»æœ€æ–°çš„ develop åˆ†æ”¯åˆ›å»º
git fetch upstream
git checkout -b feature/my-feature upstream/develop

# æˆ–ä¿®å¤ bug
git checkout -b bugfix/issue-number upstream/develop
```

### 3. å¼€å‘

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev:gateway

# å¦ä¸€ä¸ªç»ˆç«¯
npm run dev:desktop

# è¿è¡Œæµ‹è¯•ï¼ˆç›‘è§†æ¨¡å¼ï¼‰
npm run test:watch
```

### 4. æäº¤å‰æ£€æŸ¥

```bash
# è¿è¡Œæ‰€æœ‰æ£€æŸ¥
npm run pre-commit

# åŒ…æ‹¬ï¼š
# - TypeScript ç±»å‹æ£€æŸ¥
# - ESLint ä»£ç æ£€æŸ¥
# - Prettier æ ¼å¼æ£€æŸ¥
# - å•å…ƒæµ‹è¯•
```

### 5. ä¿æŒåŒæ­¥

```bash
# å®šæœŸåŒæ­¥ä¸Šæ¸¸æ›´æ”¹
git fetch upstream
git rebase upstream/develop

# è§£å†³å†²çªåç»§ç»­
git rebase --continue
```

### 6. æäº¤ PR

```bash
# æ¨é€åˆ°ä½ çš„ fork
git push origin feature/my-feature

# ç„¶ååœ¨ GitHub ä¸Šåˆ›å»º Pull Request
```

---

## ä»£ç è§„èŒƒ

### TypeScript è§„èŒƒ

```typescript
// âœ… å¥½çš„ç¤ºä¾‹

// ä½¿ç”¨æ˜ç¡®ç±»å‹
interface UserConfig {
  name: string;
  age: number;
  email?: string;
}

// å‡½æ•°æ–‡æ¡£
/**
 * åˆ›å»ºæ–°ç”¨æˆ·
 * @param config - ç”¨æˆ·é…ç½®
 * @returns åˆ›å»ºçš„ç”¨æˆ·å¯¹è±¡
 * @throws {ValidationError} å½“é…ç½®æ— æ•ˆæ—¶
 */
async function createUser(config: UserConfig): Promise<User> {
  // å®ç°
}

// é”™è¯¯å¤„ç†
async function fetchData(): Promise<Result<Data>> {
  try {
    const data = await api.fetch();
    return { success: true, data };
  } catch (error) {
    logger.error('Fetch failed', error);
    return {
      success: false,
      error: new AppError('Fetch failed', 'FETCH_ERROR', error)
    };
  }
}

// âŒ é¿å…

// ä¸è¦ä½¿ç”¨ any
function bad(data: any): any {
  return data;
}

// ä¸è¦å¿½ç•¥é”™è¯¯
try {
  riskyOperation();
} catch (e) {
  // ç©ºçš„ catch å—ï¼
}
```

### æµ‹è¯•è¦æ±‚

```typescript
// æ¯ä¸ªåŠŸèƒ½éƒ½éœ€è¦æµ‹è¯•
describe('Feature', () => {
  // æ­£å¸¸æƒ…å†µ
  it('should work correctly', async () => {
    const result = await feature.doSomething();
    expect(result).toBe(expected);
  });

  // è¾¹ç•Œæƒ…å†µ
  it('should handle empty input', async () => {
    const result = await feature.doSomething('');
    expect(result).toBeNull();
  });

  // é”™è¯¯æƒ…å†µ
  it('should throw on invalid input', async () => {
    await expect(feature.doSomething(null))
      .rejects.toThrow(ValidationError);
  });
});
```

### æ–‡ä»¶ç»„ç»‡

```
src/
â”œâ”€â”€ feature/
â”‚   â”œâ”€â”€ types.ts          # ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ index.ts          # å…¬å¼€ API
â”‚   â”œâ”€â”€ feature.ts        # ä¸»è¦å®ç°
â”‚   â”œâ”€â”€ feature.test.ts   # å•å…ƒæµ‹è¯•
â”‚   â””â”€â”€ utils.ts          # è¾…åŠ©å‡½æ•°
```

---

## æäº¤ä¿¡æ¯è§„èŒƒ

ä½¿ç”¨ [Conventional Commits](https://www.conventionalcommits.org/) è§„èŒƒã€‚

### æ ¼å¼

```
<type>(<scope>): <subject>

<body>

<footer>
```

### ç±»å‹

| ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `feat` | æ–°åŠŸèƒ½ | `feat(agents): add streaming support` |
| `fix` | ä¿®å¤ Bug | `fix(gateway): handle reconnect` |
| `docs` | æ–‡æ¡£æ›´æ–° | `docs(api): update Android docs` |
| `style` | ä»£ç æ ¼å¼ | `style: fix indentation` |
| `refactor` | é‡æ„ | `refactor(storage): simplify blob pool` |
| `perf` | æ€§èƒ½ä¼˜åŒ– | `perf(memory): reduce allocations` |
| `test` | æµ‹è¯•ç›¸å…³ | `test(agents): add unit tests` |
| `chore` | æ„å»º/å·¥å…· | `chore: update dependencies` |
| `ci` | CI/CD | `ci: add GitHub Actions` |

### èŒƒå›´

- `agents` - AI ä»£ç†æ¨¡å—
- `gateway` - ç½‘å…³æœåŠ¡
- `storage` - å­˜å‚¨æ¨¡å—
- `protocol` - é€šä¿¡åè®®
- `memory` - è®°å¿†ç³»ç»Ÿ
- `config` - é…ç½®ç®¡ç†
- `ui` - ç”¨æˆ·ç•Œé¢
- `docs` - æ–‡æ¡£
- `deps` - ä¾èµ–

### ç¤ºä¾‹

```bash
# åŠŸèƒ½æäº¤
git commit -m "feat(agents): implement streaming message response

- Add streamMessage method to Agent class
- Implement StreamChunk interface
- Update tests for streaming functionality

Closes #123"

# ä¿®å¤æäº¤
git commit -m "fix(gateway): resolve WebSocket reconnection issue

- Add exponential backoff for reconnection attempts
- Fix memory leak in connection manager
- Add connection state logging

Fixes #456"

# æ–‡æ¡£æäº¤
git commit -m "docs(api): add HarmonyOS API examples

- Add code samples for AgentManager
- Document error handling patterns
- Update quick start guide"

# ç ´åæ€§å˜æ›´
git commit -m "feat(storage)!: redesign blob storage API

BREAKING CHANGE: BlobPool.store() now returns Promise<BlobResult>
instead of Promise<string>. Update your code:

  // Before
  const hash = await pool.store(file);

  // After
  const result = await pool.store(file);
  const hash = result.hash;"
```

---

## å®¡æŸ¥æµç¨‹

### PR æ£€æŸ¥æ¸…å•

æäº¤ PR å‰è¯·ç¡®è®¤ï¼š

- [ ] ä»£ç ç¬¦åˆ TypeScript è§„èŒƒ
- [ ] æ·»åŠ äº†å¿…è¦çš„æµ‹è¯•
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡ (`npm test`)
- [ ] æ›´æ–°äº†ç›¸å…³æ–‡æ¡£
- [ ] æ²¡æœ‰å¼•å…¥æ–°çš„ lint é”™è¯¯ (`npm run lint`)
- [ ] æäº¤ä¿¡æ¯ç¬¦åˆè§„èŒƒ
- [ ] PR æè¿°æ¸…æ™°å®Œæ•´

### PR æ¨¡æ¿

```markdown
## æè¿°
ç®€è¦æè¿°è¿™ä¸ª PR åšäº†ä»€ä¹ˆ

## ç±»å‹
- [ ] Bug ä¿®å¤
- [ ] æ–°åŠŸèƒ½
- [ ] ç ´åæ€§å˜æ›´
- [ ] æ–‡æ¡£æ›´æ–°
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] ä»£ç é‡æ„

## æ£€æŸ¥æ¸…å•
- [ ] æˆ‘çš„ä»£ç ç¬¦åˆé¡¹ç›®è§„èŒƒ
- [ ] æˆ‘æ·»åŠ äº†æµ‹è¯•è¦†ç›–æ–°ä»£ç 
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] æˆ‘æ›´æ–°äº†ç›¸å…³æ–‡æ¡£

## ç›¸å…³ Issue
Fixes #(issue number)

## æˆªå›¾ï¼ˆå¦‚æœé€‚ç”¨ï¼‰

## å…¶ä»–è¯´æ˜
```

### å®¡æŸ¥æ ‡å‡†

ç»´æŠ¤è€…ä¼šæ£€æŸ¥ï¼š

1. **æ­£ç¡®æ€§** - ä»£ç æ˜¯å¦æ­£ç¡®å®ç°äº†åŠŸèƒ½
2. **æµ‹è¯•** - æ˜¯å¦æœ‰è¶³å¤Ÿçš„æµ‹è¯•è¦†ç›–
3. **æ–‡æ¡£** - æ˜¯å¦æ›´æ–°äº†ç›¸å…³æ–‡æ¡£
4. **æ€§èƒ½** - æ˜¯å¦å¼•å…¥äº†æ€§èƒ½é—®é¢˜
5. **å®‰å…¨** - æ˜¯å¦å­˜åœ¨å®‰å…¨éšæ‚£
6. **é£æ ¼** - æ˜¯å¦ç¬¦åˆä»£ç è§„èŒƒ

### åˆå¹¶ç­–ç•¥

- éœ€è¦è‡³å°‘ 1 ä¸ªç»´æŠ¤è€…æ‰¹å‡†
- æ‰€æœ‰ CI æ£€æŸ¥å¿…é¡»é€šè¿‡
- ä½¿ç”¨ "Squash and Merge" ä¿æŒå†å²æ•´æ´

---

## å‘å¸ƒæµç¨‹

### ç‰ˆæœ¬å·è§„åˆ™

éµå¾ª [Semantic Versioning](https://semver.org/lang/zh-CN/)ï¼š

- `MAJOR` - ä¸å…¼å®¹çš„ API ä¿®æ”¹
- `MINOR` - å‘ä¸‹å…¼å®¹çš„åŠŸèƒ½æ–°å¢
- `PATCH` - å‘ä¸‹å…¼å®¹çš„é—®é¢˜ä¿®å¤

### å‘å¸ƒæ­¥éª¤

```bash
# 1. æ›´æ–°ç‰ˆæœ¬å·
npm version minor

# 2. ç”Ÿæˆ changelog
npm run changelog

# 3. åˆ›å»ºå‘å¸ƒåˆ†æ”¯
git checkout -b release/v1.1.0

# 4. æœ€ç»ˆæµ‹è¯•
npm run test:all

# 5. åˆå¹¶åˆ° main
git checkout main
git merge release/v1.1.0

# 6. æ‰“æ ‡ç­¾
git tag v1.1.0

# 7. æ¨é€
git push origin main --tags
```

---

## è·å–å¸®åŠ©

- ğŸ’¬ [Discord ç¤¾åŒº](https://discord.gg/sillychat)
- ğŸ“§ [é‚®ä»¶è”ç³»](mailto:dev@sillychat.io)
- ğŸ“– [å¼€å‘æ–‡æ¡£](DEVELOPMENT.md)

---

å†æ¬¡æ„Ÿè°¢æ‚¨çš„è´¡çŒ®ï¼
